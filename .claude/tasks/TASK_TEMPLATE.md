# TASK テンプレート — 機能開発指示書

> **用途**: 機能（または機能の一部）ごとにこのファイルをコピーし、`TASKXX_<機能名>.md` として保存する  
> **参照者**: 開発者・テスタ（チームメイトがこのファイルを読んで作業する）  
> **注意**: このファイルは「何を作るか」の仕様書です。「誰がどう進めるか」は TEAMCREATE.md に記載します。

---

## 1. 基本情報

| 項目 | 内容 |
|---|---|
| タスクID | TASKXX |
| 機能名 | （例: ログインフォーム） |
| 関連 TEAMCREATE | TEAMCREATE_XXX.md |
| 対象画面 / URL | （例: /login） |
| 優先度 | 高 / 中 / 低 |

---

## 2. 機能概要

（この機能が何をするのか、ユーザー視点で簡潔に記述する）

例:
> ユーザーがメールアドレスとパスワードでログインできる。
> ログイン成功時はダッシュボード（/dashboard）にリダイレクトする。
> ログイン失敗時はエラーメッセージを表示する。

---

## 3. 対象ファイル・ディレクトリ

| 種別 | パス | 備考 |
|---|---|---|
| ページ | src/app/login/page.tsx | Next.js App Router |
| コンポーネント | src/components/auth/LoginForm.tsx | 新規作成 |
| フック | src/hooks/useAuth.ts | 新規作成 or 既存修正 |
| 型定義 | src/types/auth.ts | 共有インターフェース |
| ユニットテスト | src/components/auth/__tests__/LoginForm.test.tsx | 開発者が作成 |
| E2E テスト | e2e/auth/login.spec.ts | テスタが作成 |

> **重要**: 上記以外のファイルは変更しないこと。

---

## 4. 機能要件

### 4.1 画面仕様

（画面の構成要素、レイアウト、状態遷移を記述する）

例:
- メールアドレス入力フィールド（type="email", 必須）
- パスワード入力フィールド（type="password", 必須）
- ログインボタン（送信中は disabled + ローディング表示）
- 「パスワードを忘れた方はこちら」リンク（/forgot-password へ遷移）
- エラーメッセージ表示エリア

### 4.2 バリデーション

| フィールド | ルール | エラーメッセージ |
|---|---|---|
| メールアドレス | 必須 / email形式 | 「メールアドレスを入力してください」/「正しい形式で入力してください」 |
| パスワード | 必須 / 8文字以上 | 「パスワードを入力してください」/「8文字以上で入力してください」 |

### 4.3 API連携

| 項目 | 内容 |
|---|---|
| エンドポイント | POST /api/auth/login |
| リクエスト | `{ email: string, password: string }` |
| 成功レスポンス | `{ token: string, user: { id, name, email } }` |
| エラーレスポンス | `{ error: string, code: string }` |

### 4.4 状態管理

（状態の持ち方、コンテキスト、ストアとの連携を記述する）

例:
- ログイン状態は AuthContext で管理
- トークンは httpOnly Cookie に保存（API側で Set-Cookie）
- ユーザー情報は AuthContext の state に保持

---

## 5. 非機能要件

| 項目 | 要件 |
|---|---|
| アクセシビリティ | フォームに適切な label / aria 属性を付与。キーボード操作で完結すること |
| レスポンシブ | モバイル（375px〜）/ タブレット / デスクトップに対応 |
| パフォーマンス | 不要な再レンダリングを避ける。送信中の二重クリック防止 |
| エラーハンドリング | ネットワークエラー、タイムアウト、APIエラーそれぞれにメッセージを表示 |

---

## 6. ユニットテスト方針（開発者向け）

開発者は実装と同時に以下のユニットテストを作成すること。

| テスト観点 | 内容 |
|---|---|
| レンダリング | フォームの各要素が正しく表示されること |
| バリデーション | 空入力 / 不正形式でエラーメッセージが表示されること |
| 送信 | 正しい入力で API が呼ばれること |
| ローディング | 送信中にボタンが disabled になること |
| エラー表示 | API エラー時にエラーメッセージが表示されること |

使用ライブラリ: React Testing Library + vitest

---

## 7. E2E テスト方針（テスタ向け）

テスタは以下の Playwright E2E テストを作成すること。

| シナリオ | 期待結果 |
|---|---|
| 正常ログイン | /dashboard にリダイレクトされること |
| メールアドレス未入力で送信 | バリデーションエラーが表示されること |
| 誤ったパスワードで送信 | APIエラーメッセージが表示されること |
| ネットワークエラー | ネットワークエラーメッセージが表示されること |
| モバイル表示 | 375px幅でレイアウトが崩れないこと |

使用ライブラリ: Playwright

---

## 8. 参考情報

- 既存の類似コンポーネント: （例: src/components/auth/RegisterForm.tsx を参照）
- デザイン: （Figma URL やスクリーンショットがあれば記載）
- API ドキュメント: （Swagger URL があれば記載）

---

## 9. 備考

- （既知の制約、注意事項、前提条件などを記載）
- 関連するすべての機能とインタラクションを含めてください。基本を超えて、完全に機能する実装を作成してください。